---
title: "3rd assignment"
author: "Nischal Pokhrel"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
We're going to simulate some data that can be used in each of the following tests.

The response variable is normally distributed, and then we're going to back calculate some predictor variables.

NOTE: There are 9 questions below to answer. Do your best to answer them in full sentences. This is part of what we're practicing in this class.

QUESTION: Describe the trait that you're simulating. This can be a real trait that you are working on, or hope to work on, or it can be completely made up. 
Pay special attention to the N that you're expecting, the mean, and the sd around the mean. 

Answer-I will be working on protein expression in *Staphylococcus aureus*. I want to measure what proportion of cells (in a total population of 100 million) are involved in protein secretion of vraT protein, the vraT protein is alleged to aid in vancomycin resistance. In this context, 1 represents 1 million cells, 2 represents 2 million cells, and so on.

```{r simulate vraT expression level}
rnorm(1000, 50, 1)->vraT_expression_level 

plot(density(vraT_expression_level))
min(vraT_expression_level)
max(vraT_expression_level)

```
{r simulate predictor variable for a t test}

yes <- sample(vraT_expression_level, 500, replace=FALSE, prob = ifelse(vraT_expression_level > 0, 0.95, 0.15)) 
#### play with this line! Is the test statistically significant? When is it not?

predictor_t.test <- (vraT_expression_level %in% yes)

cbind.data.frame(vraT_expression_level, predictor_t.test) -> data

mean(data[which(data$predictor_t.test == TRUE), 1])
mean(data[which(data$predictor_t.test == FALSE), 1])

t.test(vraT_expression_level ~ predictor_t.test, data = data) 
### This performs a two-sample t-test. What would a one-sample t-test be testing? How would you do that?

### Plotting our two samples for distribution
plot(density(data[which(data$predictor_t.test == FALSE), 1]), col="red", main="Two-sample t-test")
lines(density(data[which(data$predictor_t.test == TRUE), 1]), ylim=c(0, 0.1), xlim=c(-20, 20), main="Two-sample t-test")

### Plot one-sample distribution
plot(density(data$vraT_expression_level), col="red", main="One-sample t-test")
t.test(data$vraT_expression_level) 
```
### What is this test doing?
